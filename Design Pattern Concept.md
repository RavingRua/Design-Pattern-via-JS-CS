# 设计模式

## 第一章 设计模式

在上世纪70年左右，一种被称为“**软件危机**”的现象在软件行业中出现了。落后的软件生产方式无法满足快速增长的计算机软件需求。不管是软件过程的需求和概念阶段还是开发与维护阶段都出现了众多问题。在这样的背景下，当时的人们提出了许多解决方案来解决软件行业生产力落后的问题，而**面向对象范型**的软件工程过程模型则是其中之一。

面向对象范型旨在解决从需求、分析、开发到维护流中的一系列软件工程问题，而**设计模式（Design Pattern）**则是对常见的软件工程过程的一层**抽象**。相比传统范型，面向对象软件在实际生产中有着众多优势，但是设计面向对象软件比传统范型更加困难，而设计**可复用**的面向对象软件将更加困难。设计模式不仅要解决基本的设计问题，更要把这些问题进行抽象，总结出可复用的面向对象设计模型，也就是设计模式。**不是任何问题都需要从头做起**，设计模式就是对前人所采用的优秀设计的抽象总结。

### 1.1 设计模式的定义

为了沟通，需要给设计模式下一个定义。四人帮（不要误会，是指 Erich Gamma，Richard Helm，Ralph Johnson 和 John Vlissides）在1994 年发表的《设计模式 - 可复用的面向对象软件的基础》（接下来称之为《设计模式》）描述了设计模式的**四个基本要素**[1.1]：

1. **模式名称（pattern name）**：一个助记名，确定了一个通用设计的主要方面；
2. **问题（problem）**：模式面对的问题，描述应该在什么情况下使用模式；
3. **解决方案（solution）**：描述了模式内部结构的组成已经相互关系；
4. **效果（consequences）**：描述了模式的作用以及选择模式时应该权衡的问题。

《设计模式》中对设计模式的**定义**为：“对被用来在特定场景下解决一般设计问题的类和相互通信的对象的描述”。

### 1.2 描述设计模式

《设计模式》中使用统一的格式来描述设计模式，每一个模式根据以下模板（template）被分为若干部分[1.3]：

#### 模式名和分类

模式名描述了模式的本质，模式的分类是《设计模式》中对这些模式的分类[1.5]。

#### 意图

意图回答了：模式的作用、基本原理、意图和解决的特定设计问题。

#### 别名

模式的其他名称。

#### 动机

用以说明一个设计问题以及如何用模式解决这个问题的特定情境。

#### 适用性

什么时候使用模式，使用模型来改进哪些设计问题，怎样识别这些情况。了解模式的适用性有助于在各种语言中使用模式的实现。

#### 结构

《设计模式》使用对象建模技术（OMT）对设计模式中的类进行图形化描述，UML 是 OMT 技术的一种。

#### 参与者

设计模式中的类与对象以及他们的职责。

#### 协作

模式的参与者如何与模式协作并实现职责。

#### 效果

模式怎样实现目标，需要做的权衡取舍，以及系统结构中与抽象模式无关可以独立改变的部分。

#### 实现

模式在实现时对于特定语言而言的细节问题。

#### 代码提示

用特定语言描述实现模式的代码片段。

#### 已知应用

实际生产中模式被运用的实例介绍。

#### 相关模式

哪些模式与当前模式相关，它们有哪些区别，应该如何协作。

### 1.3 模式分类

《设计模式》中为所有23种模式进行了编目[1.4]并对其进行了分类[1.5]。根据**目的**和**范围**进行分类。

目的指模式用来完成什么工作，包括创建型（Creational）、结构型（Structural）和行为型（Behavioral）。创建型和对象创建相关，结构型处理类和对象的组合，行为型描述类和对象怎样交互和分配职责。

范围指模式是用于类还是对象。类处理类与子类之间的关系，这些关系在编译时通过继承确定，是静态的。对象处理对象间的关系，是运行时动态的，大部分模式都是对象型的。

《设计模式》中给出了各个模式之间关系的具体说明图[1.5 图1-1]。

